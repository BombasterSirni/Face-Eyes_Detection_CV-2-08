# Обнаружение лиц и глаз с HaarCascades/MTCNN

Этот проект реализует систему обнаружения лиц и глаз с использованием алгоритма MTCNN (Многоуровневые каскадные свёрточные сети) и, опционально, каскадов Haar для обнаружения глаз. Программа обрабатывает изображения из набора данных LFW (Labeled Faces in the Wild) и позволяет настраивать параметры через аргументы командной строки.

## Возможности
- Обнаружение лиц с помощью MTCNN.
- Два метода обнаружения глаз: ключевые точки MTCNN или каскады Haar (настраивается через `--mtcnn-eye`).
- Применение подавления немаксимумов (NMS) для фильтрации перекрывающихся ограничивающих прямоугольников.
- Сохранение обработанных изображений в указанную папку.
- Отображение результатов в реальном времени при активации.

## Требования
- Python 3.6+
- Необходимые библиотеки (см. `requirements.txt`).

## Установка
1. Скачайте репозиторий или файлы проекта.
2. Установите зависимости:
```bash
pip install -r requirements.txt
```
3. Поместите файл каскада Haar (`haarcascade_eye_tree_eyeglasses.xml`) в папку `haarcascades` внутри директории проекта. Файл можно скачать с [GitHub OpenCV](https://github.com/opencv/opencv/tree/master/data/haarcascades).

## Использование
Запустите скрипт с следующими аргументами командной строки:

- `--max_images`: Количество обрабатываемых изображений (по умолчанию: 5).
- `--export_image_folder`: Папка для сохранения обработанных изображений (по умолчанию: "export").
- `--resize`: Коэффициент изменения размера изображений LFW (по умолчанию: 1.0).
- `--scaleFactor_eye`: Коэффициент масштабирования для каскадов Haar (по умолчанию: 1.07).
- `--minNeighbors_eye`: Минимальное количество соседей для каскадов Haar (по умолчанию: 5).
- `--iou_threshold`: Порог пересечения по объединению (IoU) для NMS (по умолчанию: 0.3).
- `--min_eye_size`: Минимальный размер глаз в пикселях (по умолчанию: 15).
- `--show`: Показывать обработанные изображения (по умолчанию: False).
- `--mtcnn-eye`: Использовать ключевые точки MTCNN для обнаружения глаз вместо каскадов Haar (по умолчанию: False).

Пример с использованием MTCNN для глаз:
```bash
python FaceEyes-Detection.py --max_images 15 --show --mtcnn-eye
```

## Структура проекта
- `FaceEyes-Detection.py`: Основной скрипт для обнаружения лиц и глаз.
- "haarcascade_eye_tree_eyeglasses.xml":  xml-файл Каскада Хаара для детекции глаз
- `requirements.txt`: Список необходимых Python-пакетов.
- `README.md`: Этот файл.

## Примечания
- Убедитесь, что текущая папка содержит haarcascade_eye_tree_eyeglasses.xml файл перед запуском
- Проект использует набор данных LFW, который автоматически загружается через `sklearn.datasets.fetch_lfw_people`.
